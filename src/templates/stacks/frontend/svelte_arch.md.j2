# SvelteKit Project Architecture

## ğŸ—ï¸ High-Level Overview

This project is built using **SvelteKit** (v2+) and **Svelte 5**.
It leverages **Runes** for reactivity and follows a "Server-First" approach using SvelteKit's loading data and form actions.

## ğŸ“‚ Directory Structure

```text
src/
â”œâ”€â”€ lib/                 # Shared code (aliased as $lib)
â”‚   â”œâ”€â”€ components/      # UI Components
â”‚   â”‚   â”œâ”€â”€ ui/          # Primitives (Buttons, Inputs)
â”‚   â”‚   â””â”€â”€ layout/      # Headers, Footers
â”‚   â”œâ”€â”€ server/          # Server-only logic (Database, Secrets)
â”‚   â”‚   â””â”€â”€ db.ts        # Database connection
â”‚   â”œâ”€â”€ state/           # Global state (Svelte 5 classes/runes)
â”‚   â””â”€â”€ utils/           # Helper functions
â”œâ”€â”€ routes/              # File-system Routing
â”‚   â”œâ”€â”€ +layout.svelte   # Root layout
â”‚   â”œâ”€â”€ +page.svelte     # Homepage
â”‚   â”œâ”€â”€ (app)/           # Route group (Protected)
â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚       â”œâ”€â”€ +page.svelte       # View
â”‚   â”‚       â”œâ”€â”€ +page.server.ts    # Server Load & Actions
â”‚   â”‚       â””â”€â”€ +layout.svelte     # Nested layout
â”‚   â””â”€â”€ api/             # API Endpoints
â”‚       â””â”€â”€ +server.ts   # Request handlers (GET, POST)
â”œâ”€â”€ app.html             # HTML Shell
â”œâ”€â”€ hooks.server.ts      # Server hooks (Auth, Middleware)
â””â”€â”€ app.d.ts             # TypeScript global types
```

## ğŸ§© Key Architectural Patterns

### 1. Svelte 5 Runes (Reactivity)
We strictly use **Runes** for all reactivity.
- **Local State:** `$state(value)`
- **Derived State:** `$derived(expression)`
- **Props:** `$props()`
- **Side Effects:** `$effect(...)`

### 2. Data Loading Strategy
- **Server Load (`+page.server.ts`):** Default choice. Runs on the server, has access to DB/Env. Passes data to the page via `data` prop.
- **Universal Load (`+page.ts`):** Use only if data can be fetched on the client (e.g., public APIs) or needs to run during client-side navigation without hitting the server.

### 3. Mutations (Form Actions)
We do not manually create API endpoints for form submissions.
- Use **Form Actions** in `+page.server.ts` (`export const actions = { default: ... }`).
- Use `use:enhance` in the form element to progressively enhance the experience (no page reload).

{% if "TailwindCSS" in libraries %}
### 4. Styling
- **Tailwind CSS** is used via PostCSS.
- Global styles are imported in `src/app.css` (or equivalent).
- Component-specific styles are allowed via `<style>` blocks but Tailwind utilities are preferred.
{% else %}
### 4. Styling
- **Scoped CSS** is the default. Styles inside `<style>` blocks are automatically scoped to the component.
- **Global CSS** is handled in `src/app.css`.
{% endif %}

### 5. Type Safety
- **App.d.ts:** Defines structure for `Locals`, `PageData`, and `Platform`.
- **Auto-generated Types:** SvelteKit generates types in `.svelte-kit/types`. Always import `PageServerLoad`, `Actions` from `./$types`.