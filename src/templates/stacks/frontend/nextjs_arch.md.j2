# Next.js Project Architecture

## ðŸ—ï¸ High-Level Overview

This project uses the **Next.js App Router** architecture to leverage React Server Components (RSC).
The core design principle is **"Server by Default"**, pushing as much logic as possible to the server to reduce client-side bundle size.

## ðŸ“‚ Directory Structure

```text
.
â”œâ”€â”€ app/                 # App Router (Routes & Layouts)
â”‚   â”œâ”€â”€ (auth)/          # Route Group: Authentication (Login/Register)
â”‚   â”œâ”€â”€ (dashboard)/     # Route Group: Protected Dashboard
â”‚   â”œâ”€â”€ api/             # Route Handlers (API Endpoints)
â”‚   â”œâ”€â”€ globals.css      # Global styles
â”‚   â”œâ”€â”€ layout.tsx       # Root layout
â”‚   â””â”€â”€ page.tsx         # Home page
â”œâ”€â”€ components/          # Shared UI Components
â”‚   â”œâ”€â”€ ui/              # Primitive components (Buttons, Inputs)
â”‚   â””â”€â”€ icons/           # Icon components
â”œâ”€â”€ lib/                 # Shared libraries and configurations
â”‚   â”œâ”€â”€ utils.ts         # CN/Clsx helpers
{% if libraries | default([]) | select("in", ["Prisma"]) | list | length > 0 %}
â”‚   â””â”€â”€ db.ts            # Prisma Client singleton
{% endif %}
{% if libraries | default([]) | select("in", ["NextAuth.js", "NextAuth"]) | list | length > 0 %}
â”‚   â””â”€â”€ auth.ts          # Auth configuration
{% endif %}
â”œâ”€â”€ types/               # TypeScript definitions
{% if libraries | default([]) | select("in", ["Prisma"]) | list | length > 0 %}
â”œâ”€â”€ prisma/              # Database schema and migrations
â”‚   â””â”€â”€ schema.prisma
{% endif %}
â”œâ”€â”€ public/              # Static assets
â””â”€â”€ ...config files
```

## ðŸ§© Key Architectural Patterns

### 1. Server vs. Client Components
- **Server Components (Default):** Used for data fetching, accessing backend resources, and keeping sensitive logic on the server.
- **Client Components (`"use client"`):** Used *only* for interactivity (onClick, onChange, useState, useEffect).
- **Pattern:** Push the `"use client"` directive down the tree to the leaf nodes (buttons, form inputs) rather than wrapping entire pages.

### 2. Data Fetching Strategy
- **Reads:** Fetch data directly inside Server Components using `async/await`.
- **Writes:** Use **Server Actions** (`"use server"`) for form submissions and mutations instead of creating API routes manually, unless an external API is required.

{% if libraries | default([]) | select("in", ["Prisma"]) | list | length > 0 %}
### 3. Database Access (Prisma)
- Database connections are instantiated in `lib/db.ts` to prevent connection exhaustion during hot-reloads.
- All database operations should happen in Server Components or Server Actions.
{% endif %}

{% if libraries | default([]) | select("in", ["NextAuth.js", "NextAuth"]) | list | length > 0 %}
### 4. Authentication
- Session management is handled via **NextAuth.js** (or Auth.js).
- Middleware (`middleware.ts`) is used to protect private routes at the edge.
{% endif %}

### 5. Layouts & Templates
- Use `layout.tsx` for UI that persists across navigation (Sidebars, Headers).
- Use `template.tsx` only if you need to reset state on navigation.

## ðŸŽ¨ Styling Architecture
{% if libraries | default([]) | select("in", ["TailwindCSS"]) | list | length > 0 %}
We use **Tailwind CSS** with a utility-first approach.
- **Global Styles:** Defined in `app/globals.css`.
- **Component Styles:** Applied directly via classes.
- **Conditional Styles:** Managed using `clsx` or `tailwind-merge`.
{% else %}
- CSS Modules are used for component-level scoping.
- Global styles are imported in the root layout.
{% endif %}