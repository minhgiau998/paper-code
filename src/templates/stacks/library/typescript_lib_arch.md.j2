# TypeScript Library Architecture

## ğŸ—ï¸ High-Level Overview

This project is a reusable **TypeScript Library**.
It's designed for **maximum compatibility**, **tree-shakability**, and excellent **Developer Experience (DX)**.

## ğŸ“‚ Directory Structure

We follow the standard structure for published NPM packages.

```text
root/
â”œâ”€â”€ src/                 # Library Source Code
â”‚   â”œâ”€â”€ index.ts         # Public API Entry Point (exports)
â”‚   â”œâ”€â”€ core/            # Core logic (data structures, algorithms)
â”‚   â”œâ”€â”€ utils/           # Helper functions
â”‚   â””â”€â”€ internal/        # Implementation details (private modules)
â”œâ”€â”€ tests/               # Unit & Integration Tests
â”‚   â”œâ”€â”€ __setup__.ts     # Test setup (mocking)
â”‚   â””â”€â”€ my-feature.test.ts
â”œâ”€â”€ types/               # Global Type Definitions (if any)
â”œâ”€â”€ scripts/             # Build/Publishing scripts
â”œâ”€â”€ .gitignore
â”œâ”€â”€ tsconfig.json        # Main TS config
â”œâ”€â”€ tsconfig.build.json  # Build-specific TS config
â”œâ”€â”€ package.json         # NPM metadata & build scripts
â””â”€â”€ README.md
```

## ğŸ§© Key Architectural Patterns

### 1. Public API (`src/index.ts`)
- **Purpose:** This is the *only* file consumers should import from.
- **Rule:** Exports only stable, well-defined functions, classes, and types. Avoid exporting internal implementation details.
- **Example:**
  ```typescript
  // src/index.ts
  export { default as doSomething } from './core/doSomething';
  export type { Options } from './core/types';
  ```

### 2. Modularity
- Break down logic into small, focused modules within `src/`.
- Use **Private Modules** (`./internal/`) that are not exported from `src/index.ts`.
- **Benefit:** Allows bundlers (Rollup, esbuild) to tree-shake unused code effectively.

### 3. Bundling & Formats
- We bundle the library into multiple formats for maximum compatibility:
  - **ESM (`.mjs`):** For modern Node.js and bundlers.
  - **CommonJS (`.cjs`):** For older Node.js versions.
  - **UMD (`.umd.js`):** For direct browser `<script>` tag usage.
- **Tools:** Use **Rollup** or **esbuild** with appropriate plugins (e.g., `@rollup/plugin-node-resolve`, `@rollup/plugin-typescript`).

### 4. Typing
- **TypeScript First:** All code is written in TypeScript.
- **Declaration Files:** Generate `.d.ts` files during the build process. Ensure they accurately reflect the public API.

## ğŸ“¦ Publishing (NPM)

- **`package.json`:**
  - `main`: Path to CommonJS entry point.
  - `module`: Path to ESM entry point.
  - `types`: Path to declaration files.
  - `files`: Include `dist/` and `src/index.ts` (for source maps).
  - `scripts`: `build` (tsc + bundler), `test`, `lint`, `publish`.
- **Versioning:** Use Semantic Versioning (SemVer).
- **`npm publish`:** Ensure tests and builds pass before publishing. Use `npm prepublishOnly` for safety checks.