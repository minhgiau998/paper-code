# Go (Cobra) Project Architecture

## ğŸ—ï¸ High-Level Overview

This project is a Command Line Interface built with **Go** using the **Cobra** framework.
It follows the [Standard Go Project Layout](https://github.com/golang-standards/project-layout), ensuring separation between the CLI entry point and the core business logic.

## ğŸ“‚ Directory Structure

```text
root/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ {{ project_name | default("mycli") | lower | replace(" ", "-") }}/
â”‚       â””â”€â”€ main.go          # Application Entry Point
â”œâ”€â”€ internal/                # Private Logic (Not importable by other apps)
â”‚   â”œâ”€â”€ config/              # Configuration loading (Viper)
â”‚   â”œâ”€â”€ commands/            # Command implementations (Optional separation)
â”‚   â””â”€â”€ app/                 # Core Business Logic
â”œâ”€â”€ pkg/                     # Public Libraries (Optional)
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ config.yaml              # Default configuration
â”œâ”€â”€ go.mod
â””â”€â”€ go.sum
```

## ğŸ§© Key Architectural Patterns

### 1. The `cmd` Directory
- **Location:** `cmd/<app-name>/main.go`
- **Responsibility:** Only bootstraps the root command and calls `Execute()`.
- **Rule:** No business logic lives here.

### 2. Command Structure
Cobra commands are defined in `cmd/` or `internal/commands/`.
- **Root Command:** Sets up global flags (verbose, config file) and initializes configuration.
- **Sub-commands:** Added via `rootCmd.AddCommand(subCmd)`.

### 3. Separation of Concerns (UI vs Logic)
- **Cobra (`RunE`):** Handles "UI" concerns: parsing flags, printing to Stdout/Stderr, and exiting.
- **Internal (`internal/app`):** Handles "Logic": interacting with files, APIs, or databases.
- **Integration:** The Cobra command calls functions in `internal/` passing the necessary context and parameters.

{% if libraries | default([]) | select("in", ["Viper"]) | list | length > 0 %}
### 4. Configuration (Viper)
- **Hierarchy:** Flags > Env Vars > Config File > Defaults.
- **Binding:** We strictly bind Cobra flags to Viper keys so that `viper.GetString("key")` works regardless of where the value came from.
- **Env Vars:** Configured with `viper.SetEnvPrefix("APP")` and `viper.AutomaticEnv()`.
{% endif %}

{% if libraries | default([]) | select("in", ["Bubbletea"]) | list | length > 0 %}
### 5. TUI (Bubbletea)
- If a command launches an interactive TUI, it initializes the **Bubbletea Model**.
- The TUI logic lives in `internal/ui/`, following The Elm Architecture (Model-View-Update).
{% endif %}

## ğŸ“¦ Distribution
- **Build:** `go build -o bin/app ./cmd/...`
- **Releasing:** We use **GoReleaser** to cross-compile binaries for Windows, macOS, and Linux automatically.