# Electron Project Architecture

## ðŸ—ï¸ High-Level Overview

This project uses **Electron** to wrap a web-based frontend into a native desktop application.
It follows the **Multi-Process Architecture** enforced by modern Electron security standards.

**Core Philosophy:** The Renderer (UI) is untrusted. The Main Process is the privileged backend. They communicate *only* via a secure Preload Bridge.

## ðŸ“‚ Directory Structure

We generally follow the **Electron-Vite** or monorepo-style structure:

```text
root/
â”œâ”€â”€ electron.vite.config.ts  # Build configuration
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                # ðŸ”´ Main Process (Node.js environment)
â”‚   â”‚   â”œâ”€â”€ index.ts         # App entry point (Window creation)
â”‚   â”‚   â”œâ”€â”€ ipc/             # IPC Handlers (API definitions)
â”‚   â”‚   â””â”€â”€ services/        # System logic (File System, OS integration)
â”‚   â”œâ”€â”€ preload/             # ðŸŸ¡ Preload Scripts (The Bridge)
â”‚   â”‚   â”œâ”€â”€ index.ts         # contextBridge exposure
â”‚   â”‚   â””â”€â”€ index.d.ts       # Type definitions for window.api
â”‚   â””â”€â”€ renderer/            # ðŸŸ¢ Renderer Process (Frontend)
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ App.tsx
â”‚       â”‚   â””â”€â”€ ... (Follows {{ tech_stack | default("web framework") }} architecture)
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ resources/               # Static binaries / icons
â””â”€â”€ package.json
```

## ðŸ§© Key Architectural Patterns

### 1. The Three Layers
1.  **Main Process (`src/main`):** The "Server". It has full OS access. It manages application lifecycle, windows, and native menus.
2.  **Preload Script (`src/preload`):** The "Gatekeeper". It runs before the web page loads. It has access to Node.js *and* the DOM, but with restrictions. It exposes a specific API to the world via `contextBridge`.
3.  **Renderer Process (`src/renderer`):** The "Client". It is a standard **{{ tech_stack | default("web framework") }}** web app. It **cannot** access `require`, `process`, or `fs` directly.

### 2. Inter-Process Communication (IPC)
We strictly use the **Two-Way Asynchronous** pattern for most operations.

- **Renderer:** Calls `window.api.invoke('channel', data)`.
- **Main:** Listens via `ipcMain.handle('channel', handler)`.
- **Why?** This returns a Promise to the renderer, making the code cleaner (async/await) compared to the old `send`/`on` event soup.

### 3. Security (Context Isolation)
- **`contextIsolation: true`** is MANDATORY.
- **`nodeIntegration: false`** is MANDATORY.
- **`sandbox: true`** is RECOMMENDED.

### 4. Native Modules
- If native Node modules (C++) are needed, they must be loaded in the **Main Process** only.
- The Renderer requests the result of the native operation via IPC.

{% if libraries | default([]) | select("in", ["Electron Builder"]) | list | length > 0 %}
### 5. Packaging
- We use **electron-builder** for distribution.
- Configuration is located in `electron-builder.yml` or `package.json`.
- Supports Auto-Updates via `electron-updater`.
{% endif %}